# ç²¾ç®€ç‰ˆé¡¹ç›®ç»“æ„è¯´æ˜

## ğŸ“ ç›®å½•ç»“æ„

```
simplified/
â”œâ”€â”€ config.py.template          # é…ç½®æ–‡ä»¶æ¨¡æ¿
â”œâ”€â”€ requirements.txt            # Pythonä¾èµ–åŒ…
â”œâ”€â”€ README.md                   # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ quick_start.sh              # Linux/Mac å¿«é€Ÿå¼€å§‹è„šæœ¬
â”œâ”€â”€ quick_start.bat             # Windows å¿«é€Ÿå¼€å§‹è„šæœ¬
â”‚
â”œâ”€â”€ dataset/                    # æ•°æ®é›†ç›®å½•
â”‚   â””â”€â”€ test_data.json         # ç¤ºä¾‹æµ‹è¯•æ•°æ®ï¼ˆ3ä¸ªå®¢æˆ·æ¡ˆä¾‹ï¼‰
â”‚
â”œâ”€â”€ generate/                   # æ•°æ®ç”Ÿæˆè„šæœ¬
â”‚   â””â”€â”€ generate_dialogue.py   # ä½¿ç”¨å¾®è°ƒåæ¨¡å‹ç”Ÿæˆå¯¹è¯
â”‚
â”œâ”€â”€ evaluate/                   # è¯„ä¼°è„šæœ¬
â”‚   â”œâ”€â”€ diversity.py           # å¤šæ ·æ€§æŒ‡æ ‡è®¡ç®—ï¼ˆè‡ªåŠ¨ï¼Œæ— éœ€APIï¼‰
â”‚   â”œâ”€â”€ ctrs.py                # CTRSè¯„ä¼°ï¼ˆéœ€è¦GPT-4oï¼‰
â”‚   â”œâ”€â”€ wai.py                 # WAIè¯„ä¼°ï¼ˆéœ€è¦GPT-4oï¼‰
â”‚   â””â”€â”€ panas.py               # PANASè¯„ä¼°ï¼ˆéœ€è¦GPT-4oï¼‰
â”‚
â””â”€â”€ prompts/                    # è¯„ä¼°æç¤ºè¯æ¨¡æ¿
    â”œâ”€â”€ ctrs/                  # CTRSè¯„ä¼°promptsï¼ˆ6ä¸ªï¼‰
    â”‚   â”œâ”€â”€ general_1_understanding.txt
    â”‚   â”œâ”€â”€ general_2_interpersonal_effectiveness.txt
    â”‚   â”œâ”€â”€ general_3_collaboration.txt
    â”‚   â”œâ”€â”€ CBT_1_guided_discovery.txt
    â”‚   â”œâ”€â”€ CBT_2_focus.txt
    â”‚   â””â”€â”€ CBT_3_strategy.txt
    â”œâ”€â”€ wai/                   # WAIè¯„ä¼°promptsï¼ˆ12ä¸ªï¼‰
    â”‚   â”œâ”€â”€ wai1.txt ~ wai12.txt
    â””â”€â”€ panas/                 # PANASè¯„ä¼°promptsï¼ˆ2ä¸ªï¼‰
        â”œâ”€â”€ panas_before.txt
        â””â”€â”€ panas_after.txt
```

## ğŸ”§ æ–‡ä»¶è¯´æ˜

### é…ç½®æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `config.py.template` | é…ç½®æ¨¡æ¿ï¼Œéœ€è¦å¤åˆ¶ä¸º `config.py` å¹¶å¡«å…¥å‡­æ® |
| `requirements.txt` | Pythonä¾èµ–åŒ…åˆ—è¡¨ |

### æ•°æ®æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `dataset/test_data.json` | ç¤ºä¾‹æµ‹è¯•æ•°æ®ï¼ŒåŒ…å«3ä¸ªä¸åŒæ€åº¦çš„å®¢æˆ·æ¡ˆä¾‹ |

### ç”Ÿæˆè„šæœ¬

| æ–‡ä»¶ | åŠŸèƒ½ | ä¾èµ– |
|------|------|------|
| `generate/generate_dialogue.py` | ä½¿ç”¨å¾®è°ƒåçš„æ¨¡å‹ç”Ÿæˆå’¨è¯¢å¯¹è¯ | vLLMæœåŠ¡ |

### è¯„ä¼°è„šæœ¬

| æ–‡ä»¶ | åŠŸèƒ½ | è¯„ä¼°æŒ‡æ ‡æ•°é‡ | éœ€è¦API |
|------|------|-------------|---------|
| `evaluate/diversity.py` | è®¡ç®—è¯æ±‡å¤šæ ·æ€§ | 4ä¸ªï¼ˆDistinct-1/2/3, EADï¼‰ | âŒ |
| `evaluate/ctrs.py` | CTRSè®¤çŸ¥æ²»ç–—è¯„åˆ† | 6ä¸ª | âœ… GPT-4o |
| `evaluate/wai.py` | WAIå·¥ä½œè”ç›Ÿé‡è¡¨ | 12ä¸ª | âœ… GPT-4o |
| `evaluate/panas.py` | PANASæƒ…æ„Ÿé‡è¡¨ | 20ä¸ªæƒ…æ„Ÿ | âœ… GPT-4o |

### Promptæ¨¡æ¿

| ç›®å½• | æ–‡ä»¶æ•° | ç”¨é€” |
|------|--------|------|
| `prompts/ctrs/` | 6ä¸ª | CTRS 6ä¸ªç»´åº¦çš„è¯„ä¼°prompt |
| `prompts/wai/` | 12ä¸ª | WAI 12ä¸ªé¡¹ç›®çš„è¯„ä¼°prompt |
| `prompts/panas/` | 2ä¸ª | PANAS å’¨è¯¢å‰/åè¯„ä¼°prompt |

## ğŸ“Š æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. è¾“å…¥æ•°æ®                                                 â”‚
â”‚    dataset/test_data.json (å®¢æˆ·åˆå§‹è®¾å®š)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. æ•°æ®ç”Ÿæˆ                                                 â”‚
â”‚    generate/generate_dialogue.py                            â”‚
â”‚    + å¾®è°ƒåçš„æ¨¡å‹ (vLLMæœåŠ¡)                                 â”‚
â”‚    + å®¢æˆ·æ¨¡æ‹Ÿ (å¯é€‰LLM)                                      â”‚
â”‚    â†’ output/sessions/session_X.json                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. è¯„ä¼°                                                     â”‚
â”‚    â”œâ”€â”€ diversity.py â†’ results/diversity.json                â”‚
â”‚    â”œâ”€â”€ ctrs.py â†’ results/ctrs/ctrs_results.json             â”‚
â”‚    â”œâ”€â”€ wai.py â†’ results/wai/wai_results.json                â”‚
â”‚    â””â”€â”€ panas.py â†’ results/panas/panas_results.json          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é…ç½®

```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿
cp config.py.template config.py

# ç¼–è¾‘ config.pyï¼Œå¡«å…¥ Azure OpenAI å‡­æ®
```

### 2. å¯åŠ¨ vLLM æœåŠ¡

```bash
python3 -m vllm.entrypoints.openai.api_server \
  --model /path/to/your/finetuned/model \
  --dtype float16 \
  --host 0.0.0.0 \
  --port 8000
```

### 3. è¿è¡Œå¿«é€Ÿå¼€å§‹è„šæœ¬

**Linux/Mac:**
```bash
bash quick_start.sh
```

**Windows:**
```cmd
quick_start.bat
```

## ğŸ“ˆ è¯„ä¼°æŒ‡æ ‡æ€»è§ˆ

| ç±»åˆ« | æŒ‡æ ‡ | æ•°é‡ | åˆ†æ•°èŒƒå›´ | è¯´æ˜ |
|------|------|------|----------|------|
| **å¤šæ ·æ€§** | Distinct-1/2/3, EAD | 4 | 0-1 | è¯æ±‡å¤šæ ·æ€§ï¼Œè¶Šé«˜è¶Šå¥½ |
| **CTRS** | é€šç”¨æŠ€èƒ½ + CBTæŠ€èƒ½ | 6 | 0-6 | å’¨è¯¢å¸ˆä¸“ä¸šèƒ½åŠ› |
| **WAI** | Goal + Task + Bond | 12 | 1-7 | æ²»ç–—è”ç›Ÿè´¨é‡ |
| **PANAS** | ç§¯æ/æ¶ˆææƒ…æ„Ÿ | 20 | 1-5 | æƒ…æ„ŸçŠ¶æ€å˜åŒ– |

## ğŸ’¡ ä½¿ç”¨å»ºè®®

1. **æµ‹è¯•é˜¶æ®µ**ï¼šä½¿ç”¨ `--max_iter 1` å‡å°‘APIè°ƒç”¨
2. **å®Œæ•´è¯„ä¼°**ï¼šä½¿ç”¨ `--max_iter 3` è·å¾—æ›´ç¨³å®šçš„ç»“æœ
3. **æˆæœ¬æ§åˆ¶**ï¼šå…ˆç”¨å°‘é‡æ•°æ®æµ‹è¯•ï¼Œç¡®è®¤é…ç½®æ­£ç¡®åå†æ‰¹é‡è¿è¡Œ
4. **å¹¶è¡Œå¤„ç†**ï¼šç”Ÿæˆé˜¶æ®µå¯ä½¿ç”¨ `--num_processes` åŠ é€Ÿ

## ğŸ” æ•…éšœæ’æŸ¥

### vLLM è¿æ¥å¤±è´¥
- ç¡®è®¤ vLLM æœåŠ¡å·²å¯åŠ¨
- æ£€æŸ¥ç«¯å£æ˜¯å¦æ­£ç¡®ï¼ˆé»˜è®¤8000ï¼‰
- ç¡®è®¤æ¨¡å‹è·¯å¾„æ­£ç¡®

### Azure OpenAI é”™è¯¯
- æ£€æŸ¥ API key æ˜¯å¦æ­£ç¡®
- ç¡®è®¤ endpoint URL æ­£ç¡®
- æ£€æŸ¥éƒ¨ç½²åç§°æ˜¯å¦å­˜åœ¨
- ç¡®è®¤ API é…é¢å……è¶³

### å®¢æˆ·æ¨¡æ‹Ÿé—®é¢˜
- å¦‚æœä¸ä½¿ç”¨ `--use_client_llm`ï¼Œå®¢æˆ·å›å¤ä¼šæ˜¯å ä½ç¬¦
- å»ºè®®é…ç½®å®¢æˆ·LLMä»¥è·å¾—æ›´çœŸå®çš„å¯¹è¯
